<ion-header>
  <ion-navbar color="dark">
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>
      <img class="logo-suap" src="assets/logo.png" style="vertical-align: middle;" />
    </ion-title>
  </ion-navbar>
</ion-header>

<ion-content padding>
  <h5 text-center>Setores</h5>

  <ion-list>
    <ion-item>
      <ion-label>Filtrar por campus</ion-label>
      <ion-select [(ngModel)]="params.uo" cancelText="Cancelar" okText="Ok" (ngModelChange)="atualizar_setores()">
        <ion-option value="">Todos</ion-option>
        <ion-option *ngFor="let campus of unidades_organizacionais" [value]="campus.sigla">{{ campus.sigla }}</ion-option>
      </ion-select>
    </ion-item>
    <ion-item>
      <ion-label>Buscar por sigla</ion-label>
      <ion-input type="text" [(ngModel)]="params.sigla" [value]="params.sigla" clearInput="true" clearOnEdit="true"></ion-input>
    </ion-item>
    <ion-item>
      <ion-label>Buscar por nome</ion-label>
      <ion-input type="text" [(ngModel)]="params.nome" [value]="params.nome" clearInput="true" clearOnEdit="true"></ion-input>
    </ion-item>
    
    <button ion-item detail-none (click)="atualizar_setores()">
      Buscar
      <ion-icon item-right name="search"></ion-icon>
    </button>
  </ion-list>

  <ion-list>
    <ion-item text-wrap *ngFor="let setor of setores">
      <h2><strong>{{ setor.sigla }}</strong></h2>
      <h3>{{ setor.nome }}</h3>
      <small>
        <span *ngFor="let hierarquia of setor.hierarquia; let last = last">
          {{ hierarquia }} <span *ngIf="!last"> â†’ </span>
        </span>
      </small>
      
      <div *ngIf="setor.telefones.length > 0">
        <strong>Telefones</strong>: {{ setor.telefones }}
      </div>
      <div *ngIf="setor.chefes.length > 0">
        <strong>Chefe</strong>: {{ setor.chefes }}
      </div>
      <div *ngIf="setor.chefes.length > 0">
        <strong>Qtd. de Servidores</strong>: {{ setor.total_servidores }}
      </div>
    </ion-item>
  </ion-list>

  <ion-list *ngIf="setores.length == 0">
    <ion-item>
      <ion-badge color="subtle">Nenhum setor encontrado.</ion-badge>
    </ion-item>
  </ion-list>

  <ion-infinite-scroll (ionInfinite)="doInfinite($event)">
    <ion-infinite-scroll-content></ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>
